{
    "builders": [
        {
            "name": "development",
            "type": "docker",
            "image": "fedora:20",
            "commit": true,
            "run_command": ["-d", "-i", "-t", "{{.Image}}", "/bin/sh"]
        }
    ],
    "provisioners": [
        {
            "type": "shell",
            "inline": [
                "yum install -y ruby gem",
                "gem install puppet"
            ]
        },
        {   "type": "shell",
            "inline": [
                "cd /src/test-baserock-infrastructure/baserock_storyboard",
                "puppet module build puppet-storyboard",
                "puppet module install puppet-storyboard/pkg/openstack-storyboard-*.*.*.tar.gz",
                "puppet module install camptocamp-openssl"
            ]
        },
        {
            "type": "puppet-masterless",
            "manifest_file": "baserock_storyboard/site.pp"
        }
    ],
    "post-processors": [
        [
            {
                "type": "docker-tag",
                "repository": "baserock/storyboard",
                "tag": "latest",
                "only": ["development"]
            }
        ]
    ]
}
